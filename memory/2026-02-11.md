# 2026-02-11 - Vercel Deployment Debugging

## Session Events

### 1. Model Switch Request (20:00 GMT+1)
- User requested permanent switch from Ollama to Claude Haiku
- Issue: Agent keeps switching back to Ollama
- Status: Provided configuration guidance; user needs to update default_model in config

### 2. WhatsApp & Telegram Setup (20:11-20:14 GMT+1)
- WhatsApp gateway connected successfully
- Telegram channel confirmed working
- User clarified how to access agents via different channels

### 3. Vercel Frontend Deployment Failure (20:14-20:27+ GMT+1)
**Initial Error:** `react-scripts: command not found` (exit 127)
- Root cause: Vercel building from repo root instead of fiber-shop-landing/

**Diagnosis & Fixes Applied:**
1. ✅ Created root vercel.json with proper buildCommand (discarded - wrong approach)
2. ✅ Tried moving vercel.json to fiber-shop-landing/ (didn't work alone)
3. ✅ Set `rootDirectory: "fiber-shop-landing"` via Vercel API (v8/projects endpoint)
4. ✅ Removed git submodule integration:
   - `fiber-shop-landing` was a git submodule
   - Vercel couldn't fetch submodule content
   - Removed `.git/` from fiber-shop-landing, integrated as regular directory
   - Pushed commit 0c709bf
5. ✅ Set explicit buildCommand & installCommand in Vercel project:
   - `buildCommand: "npm run build"`
   - `installCommand: "npm ci"`
   - `outputDirectory: "build"`

**Current Status:**
- Build still failing with exit code 1
- Local build works perfectly (`npm run build` → Compiled successfully)
- Error: `Command "npm run build" exited with 1`
- **Next Step:** User needs to check Vercel inspector logs at:
  https://vercel.com/openclawlaurents-projects/openshop/DggNKnSDJXMNPYDiSPB2eeWHQzKq
  → Look at **Build** tab for full error output

**Key Commits:**
- b0abea9: remove root vercel.json, rely on rootDirectory setting
- 0c709bf: trigger vercel redeploy (after removing submodule)
- 654353a: retrigger deploy (with explicit install/build commands)

**Vercel API Token:** Stored in .env (secret, do not commit)

## Insights
- Submodules are a deployment headache with Vercel—integrated now as regular directory
- Local builds work, so it's an environment-specific issue
- Vercel inspector logs are the key diagnostic tool

